<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2c5aa0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Elder Care Management - Puerto Rico</title>
    
    <!-- Favicon / App Icons -->
    <link rel="icon" type="image/png" href="attached_assets/generated_images/medical_cross_heart_logo.png">
    <link rel="shortcut icon" type="image/png" href="attached_assets/generated_images/medical_cross_heart_logo.png">
    <link rel="apple-touch-icon" href="attached_assets/generated_images/medical_cross_heart_logo.png">
    <!-- When you create favicon.ico, uncomment the line below and place favicon.ico in the root directory -->
    <!-- <link rel="icon" type="image/x-icon" href="favicon.ico"> -->
    
    <link rel="stylesheet" href="style.css">
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <!-- Login Modal -->
    <div id="loginModal" class="modal" style="display: block;">
        <div class="form-card login-card">
            <h2 class="login-title">üè• Elder Care Management</h2>
            <h3 class="login-subtitle">Iniciar Sesi√≥n / Login</h3>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="loginUsername">Usuario / Username *</label>
                    <input type="text" id="loginUsername" required autocomplete="username" placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Contrase√±a / Password *</label>
                    <input type="password" id="loginPassword" required autocomplete="current-password" placeholder="Enter password">
                </div>
                <div class="button-group">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Iniciar Sesi√≥n / Login</button>
                </div>
            </form>
            <p class="login-hint">Default: admin / admin123</p>
        </div>
    </div>

    <!-- Resident Selector -->
    <div id="residentSelector" class="modal" style="display: none;">
        <div class="form-card">
            <h2>Select Resident / Seleccionar Residente</h2>
            <div class="form-group">
                <label for="residentSelect">Choose Resident *</label>
                <select id="residentSelect" class="form-control" required>
                    <option value="">-- Select a resident --</option>
                </select>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="selectResident()">Continue / Continuar</button>
                <button class="btn btn-secondary" onclick="showAddResidentForm()">+ Add New Resident / Agregar Residente</button>
            </div>
            
            <!-- Add Resident Form -->
            <div id="addResidentForm" class="form-card" style="display: none; margin-top: 2rem; background: var(--light-gray);">
                <h3>Add New Resident / Agregar Nuevo Residente</h3>
                <form id="newResidentForm" onsubmit="saveNewResident(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="newFirstName">First Name / Nombre *</label>
                            <input type="text" id="newFirstName" required>
                        </div>
                        <div class="form-group">
                            <label for="newLastName">Last Name / Apellido *</label>
                            <input type="text" id="newLastName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Date of Birth / Fecha de Nacimiento</label>
                            <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                <div class="form-group" style="margin: 0;">
                                    <select id="newBirthYear" class="form-control">
                                        <option value="">Year / A√±o</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="newBirthMonth" class="form-control">
                                        <option value="">Month / Mes</option>
                                        <option value="01">January / Enero</option>
                                        <option value="02">February / Febrero</option>
                                        <option value="03">March / Marzo</option>
                                        <option value="04">April / Abril</option>
                                        <option value="05">May / Mayo</option>
                                        <option value="06">June / Junio</option>
                                        <option value="07">July / Julio</option>
                                        <option value="08">August / Agosto</option>
                                        <option value="09">September / Septiembre</option>
                                        <option value="10">October / Octubre</option>
                                        <option value="11">November / Noviembre</option>
                                        <option value="12">December / Diciembre</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="newBirthDay" class="form-control">
                                        <option value="">Day / D√≠a</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="newGender">Gender / G√©nero</label>
                            <select id="newGender">
                                <option value="">-- Select --</option>
                                <option value="Male">Male / Masculino</option>
                                <option value="Female">Female / Femenino</option>
                                <option value="Other">Other / Otro</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Photo / Foto</label>
                        <div class="photo-upload-area">
                            <div id="newPhotoPreview" class="photo-preview" style="display: none;">
                                <img id="newPhotoPreviewImg" src="" alt="Preview">
                                <button type="button" class="photo-remove-btn" onclick="removeResidentPhoto()">√ó</button>
                            </div>
                            <div id="newPhotoUploadPlaceholder" class="photo-upload-placeholder">
                                <input type="file" id="newPhotoInput" accept="image/*" capture="environment" onchange="handleResidentPhotoUpload(event)" style="display: none;">
                                <label for="newPhotoInput" class="photo-upload-label">
                                    <span class="photo-upload-icon">üì∑</span>
                                    <span class="photo-upload-text">Tap to take photo / Toca para tomar foto</span>
                                    <span class="photo-upload-hint">Camera will open automatically / La c√°mara se abrir√° autom√°ticamente</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="newRoomNumber">Room Number / N√∫mero de Habitaci√≥n</label>
                            <input type="text" id="newRoomNumber">
                        </div>
                        <div class="form-group">
                            <label for="newBedNumber">Bed Number / N√∫mero de Cama</label>
                            <input type="text" id="newBedNumber">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="newEmergencyContact">Emergency Contact Name / Nombre del Contacto de Emergencia</label>
                        <input type="text" id="newEmergencyContact">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="newEmergencyPhone">Emergency Contact Phone / Tel√©fono</label>
                            <input type="tel" id="newEmergencyPhone">
                        </div>
                        <div class="form-group">
                            <label for="newEmergencyRelation">Relation / Relaci√≥n</label>
                            <input type="text" id="newEmergencyRelation" placeholder="e.g., Son, Daughter / Hijo, Hija">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="newMedicalConditions">Medical Conditions / Condiciones M√©dicas</label>
                        <textarea id="newMedicalConditions" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="newAllergies">Allergies / Alergias</label>
                        <textarea id="newAllergies" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="newDietaryRestrictions">Dietary Restrictions / Restricciones Diet√©ticas</label>
                        <textarea id="newDietaryRestrictions" rows="2"></textarea>
                    </div>
                    <div class="button-group">
                        <button type="submit" class="btn btn-success">Save Resident / Guardar Residente</button>
                        <button type="button" class="btn btn-secondary" onclick="hideAddResidentForm()">Cancel / Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Main App (hidden until login and resident selected) -->
    <div id="mainApp" style="display: none;">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-top">
                    <!-- Left: Logo, Title, and Quick Actions -->
                    <div class="nav-left">
                        <h1 class="nav-title">
                            <img src="attached_assets/generated_images/medical_cross_heart_logo.png" alt="Logo" class="nav-logo">
                            <span class="nav-title-text">Elder Care Tracker</span>
                        </h1>
                        <div class="quick-actions-nav" style="display: none;">
                            <button class="btn-icon" onclick="toggleDarkMode()" id="darkModeToggle" title="Dark Mode / Modo Oscuro">üåô</button>
                            <button class="btn-icon" onclick="printCurrentPage()" title="Print / Imprimir">üñ®Ô∏è</button>
                            <button class="btn-icon" onclick="showKeyboardShortcuts()" title="Keyboard Shortcuts / Atajos de Teclado">‚å®Ô∏è</button>
                        </div>
                    </div>
                    
                    <!-- Center: Search and Resident Info -->
                    <div class="nav-center">
                        <div id="searchContainer" class="search-container" style="display: none;">
                            <input type="text" id="globalSearch" class="search-input" placeholder="üîç Search / Buscar..." autocomplete="off">
                            <button class="btn-icon-small" onclick="clearSearch()" id="clearSearchBtn" style="display: none;">‚úï</button>
                        </div>
                        <div id="currentResidentInfo" class="resident-badge" style="display: none;">
                            <strong id="currentResidentName">No resident selected</strong>
                        </div>
                    </div>
                    
                    <!-- Right: Clock, Notifications, User Info -->
                    <div class="nav-right">
                        <div id="liveClock" class="live-clock"></div>
                        <div id="notificationsContainer" class="notifications-container" style="display: none;">
                            <button class="btn-icon notifications-bell" onclick="toggleNotifications()" id="notificationsBell" title="Notifications / Notificaciones">
                                üîî
                                <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                            </button>
                            <div id="notificationsDropdown" class="notifications-dropdown" style="display: none;">
                                <div class="notifications-header">
                                    <h4>Notifications / Notificaciones</h4>
                                    <button class="btn btn-sm btn-secondary" onclick="markAllNotificationsRead()">Mark All Read / Marcar Todas</button>
                                </div>
                                <div id="notificationsList" class="notifications-list"></div>
                                <div class="notifications-footer">
                                    <a href="#" onclick="showPage('notifications'); return false;">View All / Ver Todas</a>
                                </div>
                            </div>
                        </div>
                        <div id="userInfo" class="user-info" style="display: none;">
                            <span id="userName"></span>
                            <span class="user-role" id="userRole" style="display: none;"></span>
                            <button class="btn btn-sm btn-secondary" onclick="handleLogout()" title="Logout / Cerrar Sesi√≥n">Logout</button>
                        </div>
                        <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu">‚ò∞</button>
                    </div>
                </div>
                <!-- Navigation Menu -->
                <ul class="nav-menu" id="navMenu">
                    <li><a href="#" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                    <li><a href="#" class="nav-link" data-page="residents">Residents</a></li>
                    <li><a href="#" class="nav-link" data-page="medications">Medications</a></li>
                    <li><a href="#" class="nav-link" data-page="appointments">Appointments</a></li>
                    <li><a href="#" class="nav-link" data-page="vitalsigns">Vital Signs</a></li>
                    <li><a href="#" class="nav-link" data-page="calendar">Calendar / Calendario</a></li>
                    <li><a href="#" class="nav-link" data-page="billing">Billing / Facturaci√≥n</a></li>
                    <li><a href="#" class="nav-link" data-page="incidents">Incidents / Incidentes</a></li>
                    <li><a href="#" class="nav-link" data-page="carenotes">Care Notes / Notas de Cuidado</a></li>
                    <li><a href="#" class="nav-link" data-page="notifications">Notifications / Notificaciones</a></li>
                    <li><a href="#" class="nav-link" data-page="reports">Reports / Reportes</a></li>
                    <li><a href="#" class="nav-link" data-page="staff" id="staffNavLink" style="display: none;">Staff / Personal</a></li>
                    <li><a href="#" class="nav-link logout-link" onclick="handleLogout(); return false;" style="color: var(--danger-color);">Logout / Cerrar Sesi√≥n</a></li>
                </ul>
            </div>
        </nav>

        <main class="container">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="dashboard-header">
                    <h2>Dashboard / Panel de Control</h2>
                    <p class="dashboard-subtitle" id="dashboardDate"></p>
                </div>
                
                <!-- Stats Grid with Icons -->
                <div class="stats-grid">
                    <div class="stat-card stat-card-medications">
                        <div class="stat-icon">üíä</div>
                        <div class="stat-content">
                            <h3>Medications / Medicamentos</h3>
                            <p class="stat-number" id="medsTakenStat">0/0</p>
                            <p class="stat-label">Taken Today / Tomados Hoy</p>
                            <div class="stat-progress" id="medsProgress" style="display: none;">
                                <div class="stat-progress-bar" id="medsProgressBar"></div>
                            </div>
                        </div>
                    </div>
                    <div class="stat-card stat-card-appointments">
                        <div class="stat-icon">üìÖ</div>
                        <div class="stat-content">
                            <h3>Appointments / Citas</h3>
                            <p class="stat-number" id="apptsToday">0</p>
                            <p class="stat-label">Scheduled Today / Programadas Hoy</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-residents">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-content">
                            <h3>Residents / Residentes</h3>
                            <p class="stat-number" id="totalResidents">0</p>
                            <p class="stat-label">Active / Activos</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-vitals" id="vitalsCard" style="display: none;">
                        <div class="stat-icon">‚ù§Ô∏è</div>
                        <div class="stat-content">
                            <h3>Vital Signs / Signos Vitales</h3>
                            <p class="stat-number" id="vitalsToday">0</p>
                            <p class="stat-label">Recorded Today / Registrados Hoy</p>
                        </div>
                    </div>
                    <div class="stat-card stat-card-billing" id="billingCard" style="display: none;">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <h3>Account Balance / Saldo</h3>
                            <p class="stat-number" id="accountBalance">$0.00</p>
                            <p class="stat-label" id="balanceLabel">Balance / Saldo</p>
                        </div>
                    </div>
                </div>
                
                <!-- Dashboard Content Grid -->
                <div class="dashboard-grid">
                    <!-- Left Column -->
                    <div class="dashboard-column">
                        <!-- Quick Actions -->
                        <div class="dashboard-widget">
                            <h3>üöÄ Quick Actions / Acciones R√°pidas</h3>
                            <div class="quick-actions-grid">
                                <button class="quick-action-btn" onclick="showPage('residents')">
                                    <span class="quick-action-icon">‚ûï</span>
                                    <span>Add Resident / Agregar Residente</span>
                                </button>
                                <button class="quick-action-btn" onclick="showPage('medications')">
                                    <span class="quick-action-icon">üíä</span>
                                    <span>Add Medication / Agregar Medicamento</span>
                                </button>
                                <button class="quick-action-btn" onclick="showPage('appointments')">
                                    <span class="quick-action-icon">üìÖ</span>
                                    <span>Add Appointment / Agregar Cita</span>
                                </button>
                                <button class="quick-action-btn" onclick="showPage('vitalsigns')">
                                    <span class="quick-action-icon">‚ù§Ô∏è</span>
                                    <span>Record Vitals / Registrar Signos</span>
                                </button>
                                <button class="quick-action-btn" onclick="showPage('incidents')">
                                    <span class="quick-action-icon">‚ö†Ô∏è</span>
                                    <span>Report Incident / Reportar Incidente</span>
                                </button>
                                <button class="quick-action-btn" onclick="showPage('carenotes')">
                                    <span class="quick-action-icon">üìù</span>
                                    <span>Add Care Note / Agregar Nota</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Upcoming Appointments -->
                        <div class="dashboard-widget" id="upcomingAppointmentsWidget">
                            <h3>üìÖ Upcoming Appointments / Pr√≥ximas Citas</h3>
                            <div id="upcomingAppointmentsList" class="upcoming-list">
                                <p class="empty-state">No upcoming appointments / No hay citas pr√≥ximas</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right Column -->
                    <div class="dashboard-column">
                        <!-- Medication Reminders -->
                        <div class="dashboard-widget" id="medicationRemindersWidget">
                            <h3>‚è∞ Medication Reminders / Recordatorios de Medicamentos</h3>
                            <div id="medicationRemindersList" class="reminders-list">
                                <p class="empty-state">No medications scheduled / No hay medicamentos programados</p>
                            </div>
                        </div>
                        
                        <!-- Recent Activity -->
                        <div class="dashboard-widget" id="recentActivityWidget">
                            <h3>üìã Recent Activity / Actividad Reciente</h3>
                            <div id="recentActivityList" class="activity-list">
                                <p class="empty-state">No recent activity / No hay actividad reciente</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Residents Page -->
            <div id="residents" class="page">
                <h2>Residents Management / Gesti√≥n de Residentes</h2>
                <button class="btn btn-primary" onclick="showAddResidentForm()">+ Add New Resident / Agregar Nuevo Residente</button>
                
                <!-- Add/Edit Resident Form (for Residents page) -->
                <div id="addResidentFormPage" class="form-card" style="display: none; margin-top: 2rem;">
                    <h3>Add New Resident / Agregar Nuevo Residente</h3>
                    <form id="newResidentFormPage" onsubmit="saveNewResident(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="newFirstNamePage">First Name / Nombre *</label>
                                <input type="text" id="newFirstNamePage" required>
                            </div>
                            <div class="form-group">
                                <label for="newLastNamePage">Last Name / Apellido *</label>
                                <input type="text" id="newLastNamePage" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Date of Birth / Fecha de Nacimiento</label>
                                <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div class="form-group" style="margin: 0;">
                                        <select id="newBirthYearPage" class="form-control">
                                            <option value="">Year / A√±o</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="newBirthMonthPage" class="form-control">
                                            <option value="">Month / Mes</option>
                                            <option value="01">January / Enero</option>
                                            <option value="02">February / Febrero</option>
                                            <option value="03">March / Marzo</option>
                                            <option value="04">April / Abril</option>
                                            <option value="05">May / Mayo</option>
                                            <option value="06">June / Junio</option>
                                            <option value="07">July / Julio</option>
                                            <option value="08">August / Agosto</option>
                                            <option value="09">September / Septiembre</option>
                                            <option value="10">October / Octubre</option>
                                            <option value="11">November / Noviembre</option>
                                            <option value="12">December / Diciembre</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="newBirthDayPage" class="form-control">
                                            <option value="">Day / D√≠a</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="newGenderPage">Gender / G√©nero</label>
                                <select id="newGenderPage">
                                    <option value="">-- Select --</option>
                                    <option value="Male">Male / Masculino</option>
                                    <option value="Female">Female / Femenino</option>
                                    <option value="Other">Other / Otro</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Photo / Foto</label>
                            <div class="photo-upload-area">
                                <div id="newPhotoPreviewPage" class="photo-preview" style="display: none;">
                                    <img id="newPhotoPreviewImgPage" src="" alt="Preview">
                                    <button type="button" class="photo-remove-btn" onclick="removeResidentPhotoPage()">√ó</button>
                                </div>
                                <div id="newPhotoUploadPlaceholderPage" class="photo-upload-placeholder">
                                    <input type="file" id="newPhotoInputPage" accept="image/*" capture="environment" onchange="handleResidentPhotoUploadPage(event)" style="display: none;">
                                    <label for="newPhotoInputPage" class="photo-upload-label">
                                        <span class="photo-upload-icon">üì∑</span>
                                        <span class="photo-upload-text">Tap to take photo / Toca para tomar foto</span>
                                        <span class="photo-upload-hint">Camera will open automatically / La c√°mara se abrir√° autom√°ticamente</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="newRoomNumberPage">Room Number / N√∫mero de Habitaci√≥n</label>
                                <input type="text" id="newRoomNumberPage">
                            </div>
                            <div class="form-group">
                                <label for="newBedNumberPage">Bed Number / N√∫mero de Cama</label>
                                <input type="text" id="newBedNumberPage">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="newEmergencyContactPage">Emergency Contact Name / Nombre del Contacto de Emergencia</label>
                            <input type="text" id="newEmergencyContactPage">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="newEmergencyPhonePage">Emergency Contact Phone / Tel√©fono</label>
                                <input type="tel" id="newEmergencyPhonePage">
                            </div>
                            <div class="form-group">
                                <label for="newEmergencyRelationPage">Relation / Relaci√≥n</label>
                                <input type="text" id="newEmergencyRelationPage" placeholder="e.g., Son, Daughter / Hijo, Hija">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="newMedicalConditionsPage">Medical Conditions / Condiciones M√©dicas</label>
                            <textarea id="newMedicalConditionsPage" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="newAllergiesPage">Allergies / Alergias</label>
                            <textarea id="newAllergiesPage" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="newDietaryRestrictionsPage">Dietary Restrictions / Restricciones Diet√©ticas</label>
                            <textarea id="newDietaryRestrictionsPage" rows="2"></textarea>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save Resident / Guardar Residente</button>
                            <button type="button" class="btn btn-secondary" onclick="hideAddResidentForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="residentsList" class="item-list"></div>
            </div>

            <!-- Staff Page -->
            <div id="staff" class="page">
                <h2>Staff Management / Gesti√≥n de Personal</h2>
                <button class="btn btn-primary" onclick="showAddStaffForm()">+ Add New Staff / Agregar Nuevo Personal</button>
                
                <!-- Add/Edit Staff Form -->
                <div id="addStaffForm" class="form-card" style="display: none; margin-top: 2rem;">
                    <h3 id="staffFormTitle">Add New Staff Member / Agregar Nuevo Personal</h3>
                    <form id="newStaffForm" onsubmit="saveStaff(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="staffFullName">Full Name / Nombre Completo *</label>
                                <input type="text" id="staffFullName" required>
                            </div>
                            <div class="form-group">
                                <label for="staffUsername">Username / Nombre de Usuario *</label>
                                <input type="text" id="staffUsername" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="staffEmail">Email / Correo Electr√≥nico</label>
                                <input type="email" id="staffEmail">
                            </div>
                            <div class="form-group">
                                <label for="staffPhone">Phone / Tel√©fono</label>
                                <input type="tel" id="staffPhone">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="staffRole">Role / Rol *</label>
                                <select id="staffRole" required>
                                    <option value="caregiver">Caregiver / Cuidador</option>
                                    <option value="nurse">Nurse / Enfermero(a)</option>
                                    <option value="admin">Administrator / Administrador</option>
                                    <option value="doctor">Doctor / M√©dico</option>
                                    <option value="therapist">Therapist / Terapeuta</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="staffPassword">Password / Contrase√±a <span id="staffPasswordHint">(Leave blank to keep current)</span></label>
                                <input type="password" id="staffPassword" placeholder="Enter new password / Ingrese nueva contrase√±a">
                            </div>
                        </div>
                        <div class="form-group" id="staffActiveGroup">
                            <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                                <input type="checkbox" id="staffActive" checked>
                                <span>Active / Activo</span>
                            </label>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save Staff / Guardar Personal</button>
                            <button type="button" class="btn btn-secondary" onclick="hideAddStaffForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="staffList" class="item-list"></div>
            </div>

            <!-- Medications Page -->
            <div id="medications" class="page">
                <h2>Medication Management / Gesti√≥n de Medicamentos</h2>
                <button class="btn btn-primary" onclick="showMedicationForm()">+ Add New Medication / Agregar Medicamento</button>
                
                <div id="medicationForm" class="form-card" style="display: none;">
                    <h3>Add Medication / Agregar Medicamento</h3>
                    <form id="medForm" onsubmit="saveMedication(event)">
                        <div class="form-group">
                            <label for="medName">Medication Name / Nombre del Medicamento *</label>
                            <input type="text" id="medName" required>
                        </div>
                        <div class="form-group">
                            <label for="medDosage">Dosage / Dosis *</label>
                            <input type="text" id="medDosage" placeholder="e.g., 10mg" required>
                        </div>
                        <div class="form-group">
                            <label for="medFrequency">Frequency / Frecuencia *</label>
                            <select id="medFrequency" required onchange="handleFrequencyChange()">
                                <option value="Once daily">Once daily / Una vez al d√≠a</option>
                                <option value="Twice daily">Twice daily / Dos veces al d√≠a</option>
                                <option value="Three times daily">Three times daily / Tres veces al d√≠a</option>
                                <option value="Every 4 hours">Every 4 hours / Cada 4 horas</option>
                                <option value="Every 6 hours">Every 6 hours / Cada 6 horas</option>
                                <option value="Every 8 hours">Every 8 hours / Cada 8 horas</option>
                                <option value="At intervals">At intervals / A intervalos</option>
                                <option value="As needed">As needed / Seg√∫n sea necesario</option>
                            </select>
                        </div>
                        <div id="hoursIntervalGroup" class="form-group" style="display: none;">
                            <label>Hours Between Doses / Horas Entre Dosis</label>
                            <div class="hours-selector-compact">
                                <input type="number" id="hoursIntervalInput" min="1" max="24" value="8" class="hours-number-input" onchange="selectHourFromInput()">
                                <div class="hours-quick-select">
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(1)">1h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(2)">2h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(4)">4h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(6)">6h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(8)">8h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(12)">12h</button>
                                    <button type="button" class="hours-quick-btn" onclick="selectHour(24)">24h</button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group" id="medTimesGroup">
                            <label for="medTimes">Time(s) / Hora(s) *</label>
                            <input type="text" id="medTimes" placeholder="e.g., 08:00, 20:00" required>
                            <small>Enter times separated by commas / Ingrese horas separadas por comas</small>
                        </div>
                        <div class="form-group">
                            <label>Start Date / Fecha de Inicio</label>
                            <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                                <div class="form-group" style="margin: 0;">
                                    <select id="medStartYear" class="form-control">
                                        <option value="">Year / A√±o</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="medStartMonth" class="form-control">
                                        <option value="">Month / Mes</option>
                                        <option value="01">Jan / Ene</option>
                                        <option value="02">Feb</option>
                                        <option value="03">Mar</option>
                                        <option value="04">Apr / Abr</option>
                                        <option value="05">May / May</option>
                                        <option value="06">Jun</option>
                                        <option value="07">Jul</option>
                                        <option value="08">Aug / Ago</option>
                                        <option value="09">Sep</option>
                                        <option value="10">Oct</option>
                                        <option value="11">Nov</option>
                                        <option value="12">Dec / Dic</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="medStartDay" class="form-control">
                                        <option value="">Day / D√≠a</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <input type="time" id="medStartTime" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>End Date / Fecha de Fin</label>
                            <div class="form-group" style="margin-bottom: 0.75rem;">
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                                    <input type="checkbox" id="medNoEndDate" onchange="handleNoEndDateChange()">
                                    <span>No end date / Sin fecha de fin (Ongoing / Continuo)</span>
                                </label>
                            </div>
                            <div id="medEndDateGroup" class="form-row" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                                <div class="form-group" style="margin: 0;">
                                    <select id="medEndYear" class="form-control">
                                        <option value="">Year / A√±o</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="medEndMonth" class="form-control">
                                        <option value="">Month / Mes</option>
                                        <option value="01">Jan / Ene</option>
                                        <option value="02">Feb</option>
                                        <option value="03">Mar</option>
                                        <option value="04">Apr / Abr</option>
                                        <option value="05">May / May</option>
                                        <option value="06">Jun</option>
                                        <option value="07">Jul</option>
                                        <option value="08">Aug / Ago</option>
                                        <option value="09">Sep</option>
                                        <option value="10">Oct</option>
                                        <option value="11">Nov</option>
                                        <option value="12">Dec / Dic</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="medEndDay" class="form-control">
                                        <option value="">Day / D√≠a</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <input type="time" id="medEndTime" class="form-control">
                                </div>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save / Guardar</button>
                            <button type="button" class="btn btn-secondary" onclick="hideMedicationForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="medicationList" class="item-list"></div>
            </div>

            <!-- Appointments Page -->
            <div id="appointments" class="page">
                <h2>Appointment Tracking / Seguimiento de Citas</h2>
                <button class="btn btn-primary" onclick="showAppointmentForm()">+ Add New Appointment / Agregar Nueva Cita</button>
                
                <div id="appointmentForm" class="form-card" style="display: none;">
                    <h3>Add Appointment / Agregar Cita</h3>
                    <form id="apptForm" onsubmit="saveAppointment(event)">
                        <div class="form-group">
                            <label>Date / Fecha *</label>
                            <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                <div class="form-group" style="margin: 0;">
                                    <select id="apptYear" class="form-control" required>
                                        <option value="">Year / A√±o *</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="apptMonth" class="form-control" required>
                                        <option value="">Month / Mes *</option>
                                        <option value="01">January / Enero</option>
                                        <option value="02">February / Febrero</option>
                                        <option value="03">March / Marzo</option>
                                        <option value="04">April / Abril</option>
                                        <option value="05">May / Mayo</option>
                                        <option value="06">June / Junio</option>
                                        <option value="07">July / Julio</option>
                                        <option value="08">August / Agosto</option>
                                        <option value="09">September / Septiembre</option>
                                        <option value="10">October / Octubre</option>
                                        <option value="11">November / Noviembre</option>
                                        <option value="12">December / Diciembre</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="apptDay" class="form-control" required>
                                        <option value="">Day / D√≠a *</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="apptTime">Time / Hora *</label>
                            <input type="time" id="apptTime" required>
                        </div>
                        <div class="form-group">
                            <label for="apptDoctor">Doctor/Provider / Doctor/Proveedor *</label>
                            <input type="text" id="apptDoctor" required>
                        </div>
                        <div class="form-group">
                            <label for="apptFacility">Facility / Instalaci√≥n</label>
                            <input type="text" id="apptFacility">
                        </div>
                        <div class="form-group">
                            <label for="apptPurpose">Purpose / Prop√≥sito</label>
                            <input type="text" id="apptPurpose">
                        </div>
                        <div class="form-group">
                            <label for="apptNotes">Notes / Notas</label>
                            <textarea id="apptNotes" rows="3"></textarea>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save / Guardar</button>
                            <button type="button" class="btn btn-secondary" onclick="hideAppointmentForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="appointmentList" class="item-list"></div>
            </div>

            <!-- Vital Signs Page -->
            <div id="vitalsigns" class="page">
                <h2>Vital Signs Tracker / Registro de Signos Vitales</h2>
                
                <div class="form-card">
                    <h3>Record Vital Signs / Registrar Signos Vitales</h3>
                    <form id="vitalSignsForm" onsubmit="saveVitalSign(event)">
                        <div class="form-group">
                            <label>Date & Time / Fecha y Hora *</label>
                            <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                                <div class="form-group" style="margin: 0;">
                                    <select id="vsYear" class="form-control" required>
                                        <option value="">Year / A√±o *</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="vsMonth" class="form-control" required>
                                        <option value="">Month / Mes *</option>
                                        <option value="01">Jan / Ene</option>
                                        <option value="02">Feb</option>
                                        <option value="03">Mar</option>
                                        <option value="04">Apr / Abr</option>
                                        <option value="05">May / May</option>
                                        <option value="06">Jun</option>
                                        <option value="07">Jul</option>
                                        <option value="08">Aug / Ago</option>
                                        <option value="09">Sep</option>
                                        <option value="10">Oct</option>
                                        <option value="11">Nov</option>
                                        <option value="12">Dec / Dic</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <select id="vsDay" class="form-control" required>
                                        <option value="">Day / D√≠a *</option>
                                    </select>
                                </div>
                                <div class="form-group" style="margin: 0;">
                                    <input type="time" id="vsTime" class="form-control" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ü©∏ Blood Pressure / Presi√≥n Arterial</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="vsSystolic">Systolic (mmHg)</label>
                                    <input type="number" id="vsSystolic" min="0" max="300" placeholder="120">
                                </div>
                                <div class="form-group">
                                    <label for="vsDiastolic">Diastolic (mmHg)</label>
                                    <input type="number" id="vsDiastolic" min="0" max="200" placeholder="80">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>ü©π Blood Glucose / Glucosa en Sangre</h4>
                            <div class="form-group">
                                <label for="vsGlucose">Glucose Level (mg/dL)</label>
                                <input type="number" id="vsGlucose" min="0" max="600" step="0.1" placeholder="100">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>üå°Ô∏è Temperature / Temperatura</h4>
                            <div class="form-group">
                                <label for="vsTemperature">Temperature (¬∞F)</label>
                                <input type="number" id="vsTemperature" min="90" max="110" step="0.1" placeholder="98.6">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>‚ù§Ô∏è Heart Rate / Frecuencia Card√≠aca</h4>
                            <div class="form-group">
                                <label for="vsHeartRate">Heart Rate (bpm)</label>
                                <input type="number" id="vsHeartRate" min="30" max="200" placeholder="72">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h4>‚öñÔ∏è Weight / Peso</h4>
                            <div class="form-group">
                                <label for="vsWeight">Weight (lbs)</label>
                                <input type="number" id="vsWeight" min="0" max="1000" step="0.1" placeholder="150">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="vsNotes">Notes / Notas</label>
                            <textarea id="vsNotes" rows="2" placeholder="Any observations..."></textarea>
                        </div>
                        
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">üíæ Save Vital Signs / Guardar Signos Vitales</button>
                            <button type="button" class="btn btn-secondary" onclick="clearVitalSignsForm()">Clear / Limpiar</button>
                        </div>
                    </form>
                </div>
                
                <div style="margin-top: 2rem;">
                    <h3>Vital Signs History / Historial de Signos Vitales</h3>
                    <div id="vitalSignsList" class="item-list"></div>
                </div>
            </div>

            <!-- Calendar Page -->
            <div id="calendar" class="page">
                <h2>Activity Calendar / Calendario de Actividades</h2>
                
                <div class="form-card">
                    <div class="calendar-controls" style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; margin-bottom: 1.5rem;">
                        <div class="form-group" style="margin: 0; flex: 1; min-width: 120px;">
                            <label for="calendarYear" style="font-size: 0.9rem; margin-bottom: 0.25rem;">Year / A√±o</label>
                            <select id="calendarYear" class="form-control" style="padding: 0.5rem;">
                            </select>
                        </div>
                        <div class="form-group" style="margin: 0; flex: 1; min-width: 150px;">
                            <label for="calendarMonth" style="font-size: 0.9rem; margin-bottom: 0.25rem;">Month / Mes</label>
                            <select id="calendarMonth" class="form-control" style="padding: 0.5rem;">
                                <option value="0">January / Enero</option>
                                <option value="1">February / Febrero</option>
                                <option value="2">March / Marzo</option>
                                <option value="3">April / Abril</option>
                                <option value="4">May / Mayo</option>
                                <option value="5">June / Junio</option>
                                <option value="6">July / Julio</option>
                                <option value="7">August / Agosto</option>
                                <option value="8">September / Septiembre</option>
                                <option value="9">October / Octubre</option>
                                <option value="10">November / Noviembre</option>
                                <option value="11">December / Diciembre</option>
                            </select>
                        </div>
                        <div style="display: flex; gap: 0.5rem; align-items: flex-end;">
                            <button class="btn btn-secondary" onclick="changeCalendarMonth(-1)">‚Üê Previous / Anterior</button>
                            <button class="btn btn-secondary" onclick="changeCalendarMonth(1)">Next / Siguiente ‚Üí</button>
                            <button class="btn btn-primary" onclick="goToToday()">Today / Hoy</button>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label for="calendarSearch" style="font-size: 0.9rem; margin-bottom: 0.25rem;">Search Activities / Buscar Actividades</label>
                        <input type="text" id="calendarSearch" class="form-control" placeholder="Search by name, doctor, medication... / Buscar por nombre, doctor, medicamento..." style="padding: 0.5rem;">
                    </div>
                </div>
                
                <div id="calendarDisplay" class="calendar-container"></div>
            </div>

            <!-- Billing Page -->
            <div id="billing" class="page">
                <h2>Billing & Payments / Facturaci√≥n y Pagos</h2>
                
                <!-- Account Balance Summary -->
                <div id="accountBalanceCard" class="form-card" style="display: none;">
                    <h3>Account Balance / Saldo de Cuenta</h3>
                    <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); margin-top: 1rem;">
                        <div class="stat-card">
                            <h4>Total Billed / Total Facturado</h4>
                            <p class="stat-number" id="totalBilled">$0.00</p>
                        </div>
                        <div class="stat-card">
                            <h4>Total Paid / Total Pagado</h4>
                            <p class="stat-number" style="color: var(--success-green);" id="totalPaid">$0.00</p>
                        </div>
                        <div class="stat-card">
                            <h4>Balance / Saldo</h4>
                            <p class="stat-number" id="currentBalance">$0.00</p>
                        </div>
                        <div class="stat-card">
                            <h4>Pending / Pendiente</h4>
                            <p class="stat-number" style="color: var(--warning-color);" id="pendingAmount">$0.00</p>
                        </div>
                    </div>
                </div>

                <!-- Add Bill Form -->
                <div class="form-card">
                    <h3>Create Bill / Crear Factura</h3>
                    <button class="btn btn-primary" onclick="showBillForm()">+ Add New Bill / Agregar Nueva Factura</button>
                    
                    <div id="billForm" style="display: none; margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--light-gray);">
                        <form id="newBillForm" onsubmit="saveBill(event)">
                            <div class="form-group">
                                <label>Billing Date / Fecha de Factura *</label>
                                <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billYear" class="form-control" required>
                                            <option value="">Year / A√±o *</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billMonth" class="form-control" required>
                                            <option value="">Month / Mes *</option>
                                            <option value="01">January / Enero</option>
                                            <option value="02">February / Febrero</option>
                                            <option value="03">March / Marzo</option>
                                            <option value="04">April / Abril</option>
                                            <option value="05">May / Mayo</option>
                                            <option value="06">June / Junio</option>
                                            <option value="07">July / Julio</option>
                                            <option value="08">August / Agosto</option>
                                            <option value="09">September / Septiembre</option>
                                            <option value="10">October / Octubre</option>
                                            <option value="11">November / Noviembre</option>
                                            <option value="12">December / Diciembre</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billDay" class="form-control" required>
                                            <option value="">Day / D√≠a *</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Due Date / Fecha de Vencimiento *</label>
                                <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billDueYear" class="form-control" required>
                                            <option value="">Year / A√±o *</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billDueMonth" class="form-control" required>
                                            <option value="">Month / Mes *</option>
                                            <option value="01">January / Enero</option>
                                            <option value="02">February / Febrero</option>
                                            <option value="03">March / Marzo</option>
                                            <option value="04">April / Abril</option>
                                            <option value="05">May / Mayo</option>
                                            <option value="06">June / Junio</option>
                                            <option value="07">July / Julio</option>
                                            <option value="08">August / Agosto</option>
                                            <option value="09">September / Septiembre</option>
                                            <option value="10">October / Octubre</option>
                                            <option value="11">November / Noviembre</option>
                                            <option value="12">December / Diciembre</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="billDueDay" class="form-control" required>
                                            <option value="">Day / D√≠a *</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="billAmount">Amount / Monto ($) *</label>
                                    <input type="number" id="billAmount" step="0.01" min="0" required placeholder="0.00">
                                </div>
                                <div class="form-group">
                                    <label for="billCategory">Category / Categor√≠a</label>
                                    <select id="billCategory">
                                        <option value="Monthly Fee">Monthly Fee / Cuota Mensual</option>
                                        <option value="Medical Services">Medical Services / Servicios M√©dicos</option>
                                        <option value="Medications">Medications / Medicamentos</option>
                                        <option value="Special Care">Special Care / Cuidado Especial</option>
                                        <option value="Other">Other / Otro</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="billDescription">Description / Descripci√≥n</label>
                                <input type="text" id="billDescription" placeholder="e.g., Monthly care fee for December">
                            </div>
                            <div class="form-group">
                                <label for="billNotes">Notes / Notas</label>
                                <textarea id="billNotes" rows="2"></textarea>
                            </div>
                            <div class="button-group">
                                <button type="submit" class="btn btn-success">Save Bill / Guardar Factura</button>
                                <button type="button" class="btn btn-secondary" onclick="hideBillForm()">Cancel / Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Record Payment Form -->
                <div class="form-card">
                    <h3>Record Payment / Registrar Pago</h3>
                    <button class="btn btn-primary" onclick="showPaymentForm()">+ Record Payment / Registrar Pago</button>
                    
                    <div id="paymentForm" style="display: none; margin-top: 2rem; padding-top: 2rem; border-top: 2px solid var(--light-gray);">
                        <form id="newPaymentForm" onsubmit="savePayment(event)">
                            <div class="form-group">
                                <label>Payment Date / Fecha de Pago *</label>
                                <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
                                    <div class="form-group" style="margin: 0;">
                                        <select id="paymentYear" class="form-control" required>
                                            <option value="">Year / A√±o *</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="paymentMonth" class="form-control" required>
                                            <option value="">Month / Mes *</option>
                                            <option value="01">January / Enero</option>
                                            <option value="02">February / Febrero</option>
                                            <option value="03">March / Marzo</option>
                                            <option value="04">April / Abril</option>
                                            <option value="05">May / Mayo</option>
                                            <option value="06">June / Junio</option>
                                            <option value="07">July / Julio</option>
                                            <option value="08">August / Agosto</option>
                                            <option value="09">September / Septiembre</option>
                                            <option value="10">October / Octubre</option>
                                            <option value="11">November / Noviembre</option>
                                            <option value="12">December / Diciembre</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin: 0;">
                                        <select id="paymentDay" class="form-control" required>
                                            <option value="">Day / D√≠a *</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                <div class="form-group">
                                    <label for="paymentAmount">Amount / Monto ($) *</label>
                                    <input type="number" id="paymentAmount" step="0.01" min="0" required placeholder="0.00">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="paymentMethod">Payment Method / M√©todo de Pago</label>
                                    <select id="paymentMethod">
                                        <option value="Cash">Cash / Efectivo</option>
                                        <option value="Check">Check / Cheque</option>
                                        <option value="Credit Card">Credit Card / Tarjeta de Cr√©dito</option>
                                        <option value="Debit Card">Debit Card / Tarjeta de D√©bito</option>
                                        <option value="Bank Transfer">Bank Transfer / Transferencia Bancaria</option>
                                        <option value="Other">Other / Otro</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="paymentReference">Reference Number / N√∫mero de Referencia</label>
                                    <input type="text" id="paymentReference" placeholder="Check #, Transaction ID, etc.">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="paymentBillId">Apply to Bill / Aplicar a Factura (Optional)</label>
                                <select id="paymentBillId">
                                    <option value="">-- Select bill -- / Seleccionar factura</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="paymentNotes">Notes / Notas</label>
                                <textarea id="paymentNotes" rows="2"></textarea>
                            </div>
                            <div class="button-group">
                                <button type="submit" class="btn btn-success">Record Payment / Registrar Pago</button>
                                <button type="button" class="btn btn-secondary" onclick="hidePaymentForm()">Cancel / Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Bills List -->
                <div style="margin-top: 2rem;">
                    <h3>Bills / Facturas</h3>
                    <div id="billsList" class="item-list"></div>
                </div>

                <!-- Payments List -->
                <div style="margin-top: 2rem;">
                    <h3>Payment History / Historial de Pagos</h3>
                    <div id="paymentsList" class="item-list"></div>
                </div>
            </div>

            <!-- Incident Reports Page -->
            <div id="incidents" class="page">
                <h2 style="display: block !important; visibility: visible !important; opacity: 1 !important; color: var(--text-color) !important; margin-bottom: 1.5rem !important;">Incident Reports / Reportes de Incidentes</h2>
                <button class="btn btn-primary" onclick="showIncidentForm()" style="display: inline-block !important; visibility: visible !important; opacity: 1 !important; margin-bottom: 1.5rem !important; cursor: pointer !important;">+ Report Incident / Reportar Incidente</button>
                
                <!-- Incident Form -->
                <div id="incidentForm" class="form-card" style="display: none; margin-top: 2rem;">
                    <h3 id="incidentFormTitle">Report Incident / Reportar Incidente</h3>
                    <form id="newIncidentForm" onsubmit="saveIncident(event)" enctype="multipart/form-data">
                        <!-- Timestamp Section -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incidentDate">Incident Date & Time / Fecha y Hora del Incidente *</label>
                                <input type="datetime-local" id="incidentDate" required>
                                <small class="form-hint">Timestamp when the incident occurred / Marca de tiempo cuando ocurri√≥ el incidente</small>
                            </div>
                        </div>
                        
                        <!-- Staff and Residents Section -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incidentStaffId">Reporting Staff / Personal que Reporta *</label>
                                <select id="incidentStaffId" required>
                                    <option value="">-- Select Staff / Seleccionar Personal --</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="incidentResidents">Residents Involved / Residentes Involucrados *</label>
                                <select id="incidentResidents" multiple required style="min-height: 120px;">
                                    <option value="">-- Select Residents / Seleccionar Residentes --</option>
                                </select>
                                <small class="form-hint">Hold Ctrl/Cmd to select multiple / Mantenga Ctrl/Cmd para seleccionar m√∫ltiples</small>
                            </div>
                        </div>
                        
                        <!-- Incident Type and Severity -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incidentType">Incident Type / Tipo de Incidente *</label>
                                <select id="incidentType" required>
                                    <option value="">-- Select --</option>
                                    <option value="Fall">Fall / Ca√≠da</option>
                                    <option value="Injury">Injury / Lesi√≥n</option>
                                    <option value="Medication Error">Medication Error / Error de Medicamento</option>
                                    <option value="Behavioral">Behavioral / Conductual</option>
                                    <option value="Medical Emergency">Medical Emergency / Emergencia M√©dica</option>
                                    <option value="Equipment Failure">Equipment Failure / Falla de Equipo</option>
                                    <option value="Other">Other / Otro</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="incidentSeverity">Severity / Gravedad *</label>
                                <select id="incidentSeverity" required>
                                    <option value="minor">Minor / Menor</option>
                                    <option value="moderate">Moderate / Moderado</option>
                                    <option value="major">Major / Mayor</option>
                                    <option value="critical">Critical / Cr√≠tico</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Location -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incidentLocation">Location / Ubicaci√≥n</label>
                                <input type="text" id="incidentLocation" placeholder="e.g., Room 101, Dining Hall">
                            </div>
                        </div>
                        
                        <!-- Description Section -->
                        <div class="form-group">
                            <label for="incidentDescription">Description / Descripci√≥n del Incidente *</label>
                            <textarea id="incidentDescription" rows="6" required placeholder="Provide a detailed description of what happened, who was involved, and any immediate observations... / Proporcione una descripci√≥n detallada de lo que sucedi√≥, qui√©n estuvo involucrado y cualquier observaci√≥n inmediata..."></textarea>
                        </div>
                        
                        <!-- Photo Upload Section -->
                        <div class="form-group">
                            <label>Incident Photos / Fotos del Incidente</label>
                            <div class="photo-upload-area" id="incidentPhotoArea">
                                <input type="file" id="incidentPhotos" multiple accept="image/*" capture="environment" style="display: none;" onchange="handleIncidentPhotos(event)">
                                <div class="photo-upload-placeholder" onclick="document.getElementById('incidentPhotos').click()">
                                    <div class="photo-upload-icon">üì∑</div>
                                    <p><strong>Tap to Upload Photos / Toca para Subir Fotos</strong></p>
                                    <p>Camera will open automatically / La c√°mara se abrir√° autom√°ticamente</p>
                                    <p class="photo-upload-hint">You can select multiple photos / Puedes seleccionar m√∫ltiples fotos</p>
                                </div>
                                <div id="incidentPhotoPreview" class="photo-preview-grid"></div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="incidentWitnesses">Witnesses / Testigos</label>
                                <input type="text" id="incidentWitnesses" placeholder="Names of witnesses">
                            </div>
                            <div class="form-group">
                                <label for="incidentActions">Actions Taken / Acciones Tomadas</label>
                                <textarea id="incidentActions" rows="3" placeholder="What was done in response..."></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                                    <input type="checkbox" id="incidentFamilyNotified">
                                    <span>Family Notified / Familia Notificada</span>
                                </label>
                            </div>
                            <div class="form-group" id="familyNotificationDateGroup" style="display: none;">
                                <label for="familyNotificationDate">Notification Date / Fecha de Notificaci√≥n</label>
                                <input type="datetime-local" id="familyNotificationDate">
                            </div>
                        </div>
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 0.5rem; font-weight: normal; cursor: pointer;">
                                <input type="checkbox" id="incidentFollowUp">
                                <span>Follow-up Required / Seguimiento Requerido</span>
                            </label>
                        </div>
                        <div class="form-group" id="followUpNotesGroup" style="display: none;">
                            <label for="followUpNotes">Follow-up Notes / Notas de Seguimiento</label>
                            <textarea id="followUpNotes" rows="2"></textarea>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save Report / Guardar Reporte</button>
                            <button type="button" class="btn btn-secondary" onclick="hideIncidentForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="incidentsList" class="item-list" style="margin-top: 2rem; display: block !important; visibility: visible !important; opacity: 1 !important; min-height: 200px !important; width: 100% !important;"></div>
            </div>

            <!-- Daily Care Notes Page -->
            <div id="carenotes" class="page">
                <h2>Daily Care Notes / Notas Diarias de Cuidado</h2>
                <button class="btn btn-primary" onclick="showCareNoteForm()">+ Add Care Note / Agregar Nota de Cuidado</button>
                
                <!-- Care Note Form -->
                <div id="careNoteForm" class="form-card" style="display: none; margin-top: 2rem;">
                    <h3 id="careNoteFormTitle">Add Care Note / Agregar Nota de Cuidado</h3>
                    <form id="newCareNoteForm" onsubmit="saveCareNote(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="careNoteDate">Date / Fecha *</label>
                                <input type="date" id="careNoteDate" required>
                            </div>
                            <div class="form-group">
                                <label for="careNoteShift">Shift / Turno</label>
                                <select id="careNoteShift">
                                    <option value="">-- Select --</option>
                                    <option value="Morning">Morning / Ma√±ana</option>
                                    <option value="Afternoon">Afternoon / Tarde</option>
                                    <option value="Evening">Evening / Noche</option>
                                    <option value="Night">Night / Noche</option>
                                </select>
                            </div>
                        </div>
                        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">Meals / Comidas</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mealBreakfast">Breakfast / Desayuno</label>
                                <textarea id="mealBreakfast" rows="2" placeholder="What was eaten, how much..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="mealLunch">Lunch / Almuerzo</label>
                                <textarea id="mealLunch" rows="2" placeholder="What was eaten, how much..."></textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mealDinner">Dinner / Cena</label>
                                <textarea id="mealDinner" rows="2" placeholder="What was eaten, how much..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="mealSnacks">Snacks / Meriendas</label>
                                <textarea id="mealSnacks" rows="2" placeholder="Snacks consumed..."></textarea>
                            </div>
                        </div>
                        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">Personal Care / Cuidado Personal</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bathing">Bathing / Ba√±o</label>
                                <textarea id="bathing" rows="2" placeholder="Bathing details..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="hygiene">Hygiene / Higiene</label>
                                <textarea id="hygiene" rows="2" placeholder="Hygiene details..."></textarea>
                            </div>
                        </div>
                        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">Sleep / Sue√±o</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="sleepHours">Hours Slept / Horas Dormidas</label>
                                <input type="number" id="sleepHours" step="0.5" min="0" max="24" placeholder="e.g., 7.5">
                            </div>
                            <div class="form-group">
                                <label for="sleepQuality">Sleep Quality / Calidad del Sue√±o</label>
                                <select id="sleepQuality">
                                    <option value="">-- Select --</option>
                                    <option value="Excellent">Excellent / Excelente</option>
                                    <option value="Good">Good / Bueno</option>
                                    <option value="Fair">Fair / Regular</option>
                                    <option value="Poor">Poor / Pobre</option>
                                    <option value="Restless">Restless / Inquieto</option>
                                </select>
                            </div>
                        </div>
                        <h4 style="margin-top: 1rem; margin-bottom: 0.5rem;">Mood & Behavior / Estado de √Ånimo y Conducta</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="mood">Mood / Estado de √Ånimo</label>
                                <select id="mood">
                                    <option value="">-- Select --</option>
                                    <option value="Happy">Happy / Feliz</option>
                                    <option value="Content">Content / Contento</option>
                                    <option value="Neutral">Neutral / Neutral</option>
                                    <option value="Sad">Sad / Triste</option>
                                    <option value="Agitated">Agitated / Agitado</option>
                                    <option value="Confused">Confused / Confundido</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="behaviorNotes">Behavior Notes / Notas de Conducta</label>
                                <textarea id="behaviorNotes" rows="3" placeholder="Behavior observations..."></textarea>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="activities">Activities / Actividades</label>
                            <textarea id="activities" rows="2" placeholder="Activities participated in..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="generalNotes">General Notes / Notas Generales</label>
                            <textarea id="generalNotes" rows="4" placeholder="Any other observations or notes..."></textarea>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-success">Save Note / Guardar Nota</button>
                            <button type="button" class="btn btn-secondary" onclick="hideCareNoteForm()">Cancel / Cancelar</button>
                        </div>
                    </form>
                </div>
                
                <div id="careNotesList" class="item-list" style="margin-top: 2rem;"></div>
            </div>

            <!-- Notifications Page -->
            <div id="notifications" class="page">
                <h2>Notifications / Notificaciones</h2>
                <div class="button-group" style="margin-bottom: 1rem;">
                    <button class="btn btn-secondary" onclick="markAllNotificationsRead()">Mark All Read / Marcar Todas como Le√≠das</button>
                    <button class="btn btn-primary" onclick="loadNotificationsPage()">Refresh / Actualizar</button>
                </div>
                <div id="notificationsPageList" class="item-list"></div>
            </div>

            <!-- Reports Page -->
            <div id="reports" class="page">
                <h2>Reports & Analytics / Reportes y An√°lisis</h2>
                
                <div class="stats-grid" style="margin-bottom: 2rem;">
                    <div class="stat-card">
                        <h3>Total Incidents / Total Incidentes</h3>
                        <p class="stat-number" id="totalIncidents">0</p>
                        <p class="stat-label">This Month / Este Mes</p>
                    </div>
                    <div class="stat-card">
                        <h3>Care Notes / Notas de Cuidado</h3>
                        <p class="stat-number" id="totalCareNotes">0</p>
                        <p class="stat-label">This Month / Este Mes</p>
                    </div>
                    <div class="stat-card">
                        <h3>Medications Due / Medicamentos Pendientes</h3>
                        <p class="stat-number" id="medicationsDue">0</p>
                        <p class="stat-label">Today / Hoy</p>
                    </div>
                    <div class="stat-card">
                        <h3>Appointments / Citas</h3>
                        <p class="stat-number" id="upcomingAppointments">0</p>
                        <p class="stat-label">This Week / Esta Semana</p>
                    </div>
                </div>

                <div class="form-card">
                    <h3>Generate Report / Generar Reporte</h3>
                    <form id="reportForm" onsubmit="generateReport(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reportType">Report Type / Tipo de Reporte *</label>
                                <select id="reportType" required>
                                    <option value="">-- Select --</option>
                                    <option value="incidents">Incident Report / Reporte de Incidentes</option>
                                    <option value="care_notes">Care Notes Summary / Resumen de Notas de Cuidado</option>
                                    <option value="medications">Medication Report / Reporte de Medicamentos</option>
                                    <option value="appointments">Appointments Report / Reporte de Citas</option>
                                    <option value="vital_signs">Vital Signs Report / Reporte de Signos Vitales</option>
                                    <option value="comprehensive">Comprehensive Report / Reporte Integral</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="reportDateFrom">From Date / Desde</label>
                                <input type="date" id="reportDateFrom">
                            </div>
                            <div class="form-group">
                                <label for="reportDateTo">To Date / Hasta</label>
                                <input type="date" id="reportDateTo">
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit" class="btn btn-primary">Generate PDF / Generar PDF</button>
                            <button type="button" class="btn btn-secondary" onclick="exportReportToCSV()">Export CSV / Exportar CSV</button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <div id="messageBox" class="message-box"></div>
    
    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal" class="modal" style="display: none;">
        <div class="form-card" style="max-width: 600px;">
            <h2>Keyboard Shortcuts / Atajos de Teclado</h2>
            <div class="shortcuts-list">
                <div class="shortcut-item">
                    <kbd>/</kbd> <span>Focus search / Enfocar b√∫squeda</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Esc</kbd> <span>Close modals / Cerrar modales</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd + P</kbd> <span>Print current page / Imprimir p√°gina actual</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Ctrl/Cmd + D</kbd> <span>Toggle dark mode / Alternar modo oscuro</span>
                </div>
                <div class="shortcut-item">
                    <kbd>1</kbd> <span>Go to Dashboard / Ir a Panel</span>
                </div>
                <div class="shortcut-item">
                    <kbd>2</kbd> <span>Go to Residents / Ir a Residentes</span>
                </div>
                <div class="shortcut-item">
                    <kbd>3</kbd> <span>Go to Medications / Ir a Medicamentos</span>
                </div>
                <div class="shortcut-item">
                    <kbd>4</kbd> <span>Go to Appointments / Ir a Citas</span>
                </div>
                <div class="shortcut-item">
                    <kbd>?</kbd> <span>Show this help / Mostrar esta ayuda</span>
                </div>
            </div>
            <div class="button-group" style="margin-top: 1.5rem;">
                <button class="btn btn-primary" onclick="hideKeyboardShortcuts()">Close / Cerrar</button>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Immediate console log to verify script is loading
        console.log('üìÑ index.html loaded');
        console.log('üåê Current URL:', window.location.href);
        console.log('üìç Hostname:', window.location.hostname);
    </script>
    <script src="script.js?v=1765615000"></script>
</body>
</html>
